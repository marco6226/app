(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"1vyt":function(n,l,t){"use strict";t.r(l);var e=t("CcnG"),o=t("cyIF"),u=t("1HIq"),i=t("qd6Z"),a=t("t8sF"),r=t("wMzM"),c=t("Pn9U"),s=t("ZZ/e"),b=t("ubo9"),p=t("u/+Y"),f=function(n,l,t,e){return new(t||(t=Promise))(function(o,u){function i(n){try{r(e.next(n))}catch(l){u(l)}}function a(n){try{r(e.throw(n))}catch(l){u(l)}}function r(n){n.done?o(n.value):new t(function(l){l(n.value)}).then(i,a)}r((e=e.apply(n,l||[])).next())})},h=function(n,l){var t,e,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function a(u){return function(a){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,e&&(o=2&u[0]?e.return:u[0]?e.throw||((o=e.return)&&o.call(e),0):e.next)&&!(o=o.call(e,u[1])).done)return o;switch(e=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,e=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=l.call(n,i)}catch(a){u=[6,a],e=0}finally{t=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}},m=function(){function n(n,l,t,e,o,u,i,a,r){this.loadingController=n,this.msgService=l,this.alertController=t,this.camera=e,this.fileOpener=o,this.file=u,this.dirService=i,this.offlineService=a,this.router=r,this.options={quality:75,destinationType:this.camera.DestinationType.FILE_URI,encodingType:this.camera.EncodingType.JPEG,correctOrientation:!0,mediaType:this.camera.MediaType.PICTURE,targetWidth:960,targetHeight:960}}return n.prototype.ngOnInit=function(){var n=this;b.b.getItem("actasLocal").then(function(l){null==l&&(l=[]),n.actasLocales=l}),this.offlineService.queryActasCopasst().then(function(l){n.actasList=[],l.data.forEach(function(l){var t=u.a.dtoToObject(l);t.ext=n.getExtension(t.documento.nombre),n.actasList.push(t)})})},n.prototype.getExtension=function(n){var l=n.split(".");return l.length>1?l[1]:null},n.prototype.navegar=function(n){this.router.navigate([n])},n.prototype.descargar=function(n){var l=this,t=this.showLoading("Descargando archivo..."),e=this.file.documentsDirectory||this.file.externalRootDirectory+"Download/",o=Math.floor(1e4*Math.sqrt(parseInt(n.id)))+"_"+n.documento.nombre;this.file.checkFile(e,o).then(function(n){return l.file.resolveDirectoryUrl(e).then(function(n){return l.file.getFile(n,o,null).then(function(n){return n.file(function(e){return t.then(function(t){t.dismiss(),l.openFile(n,e.type)})})})})}).catch(function(u){return l.downloadFile(n,e,t,o)})},n.prototype.downloadFile=function(n,l,t,e){var o=this;this.dirService.download(n.id,"cop").then(function(n){var t=new Blob([n]);return o.file.writeFile(l,e,t,{replace:!0})}).then(function(n){return n.file(function(l){return t.then(function(t){t.dismiss(),o.openFile(n,l.type)})})}).catch(function(n){alert("Error"),t.then(function(n){return n.dismiss()})})},n.prototype.openFile=function(n,l){var t=this;this.fileOpener.open(n.toURL(),l).catch(function(l){return t.msgService.showMessage({tipoMensaje:"info",mensaje:"No ha sido posible visualizar el archivo descargado",detalle:"No existe una aplicacion para abrir "+n.name+"."})})},n.prototype.openFileChooser=function(){this.fileChooser.nativeElement.click()},n.prototype.upload=function(n){var l=this;b.a.readBlobFile(n.item(0)).then(function(t){var e=b.a.blobToFile(t,n.item(0).name);l.presentAlertPrompt(e)})},n.prototype.getPicture=function(){var n=this;this.camera.getPicture(this.options).then(function(l){var t=l,e=t.lastIndexOf("/"),o=t.substring(e+1,t.length),u=window.Ionic.WebView.convertFileSrc(l);b.a.dataURLtoFile(u,o).then(function(l){return n.presentAlertPrompt(l)})})},n.prototype.presentAlertPrompt=function(n){return f(this,void 0,void 0,function(){var l,t,e=this;return h(this,function(o){switch(o.label){case 0:return l=n.name.split("."),t=l.length>1?l[1]:null,[4,this.alertController.create({header:"Subir Acta",inputs:[{name:"nombre",type:"text",placeholder:"Nombre del acta",value:l[0],max:128}],buttons:[{text:"Cancelar",role:"cancel",cssClass:"secondary"},{text:"Subir",handler:function(l){return e.subir(n,null!=t?l.nombre+"."+t:l.nombre)}}]})];case 1:return[4,o.sent().present()];case 2:return o.sent(),[2]}})})},n.prototype.subir=function(n,l){n=b.a.blobToFile(n,l),this.offlineService.getOfflineMode()?this.guardarArchivoLocal(n,l):this.subirArchivo(n)},n.prototype.guardarArchivoLocal=function(n,l){var t=this;this.file.writeFile(this.file.dataDirectory,l,n,{replace:!0}).then(function(l){var e=l;b.b.getItem("actasLocal").then(function(l){null==l&&(l=[]);var o={nombre:n.name,fechaCreacion:new Date,ext:t.getExtension(n.name),url:window.Ionic.WebView.convertFileSrc(e.nativeURL)};l.push(o),b.b.setItem("actasLocal",JSON.stringify(l)),t.actasLocales=l})})},n.prototype.subirArchivo=function(n){var l=this,t=this.showLoading("Subiendo archivo...");return new Promise(function(e,o){l.dirService.upload(n,null,"cop",null,!1).then(function(o){var u=o;u.ext=l.getExtension(u.documento.nombre),l.actasList.unshift(u),l.actasList=l.actasList.slice(),l.offlineService.getOfflineMode()&&b.b.getItem("actasCopasst").then(function(n){null==n.data&&(n.data=[]),n.count+=1,n.data.unshift(u),b.b.setItem("actasCopasst",JSON.stringify(n))}),t.then(function(t){t.dismiss(),l.msgService.showMessage({tipoMensaje:"success",mensaje:"Acta adjuntada",detalle:"Se ha subido correctamente el acta "+n.name}),e(u)})}).catch(function(n){t.then(function(t){t.dismiss(),l.dirService.manageError(n)}),o(n)})})},n.prototype.showLoading=function(n){return f(this,void 0,void 0,function(){var l;return h(this,function(t){switch(t.label){case 0:return[4,this.loadingController.create({message:n,translucent:!0})];case 1:return[4,(l=t.sent()).present()];case 2:return t.sent(),[2,l]}})})},n.prototype.sincronizar=function(n){var l=this;b.a.dataURLtoFile(n.url,n.nombre).then(function(t){l.subirArchivo(t).then(function(){return l.removerLocal(n)})}).catch(function(t){l.msgService.showMessage({tipoMensaje:"warn",mensaje:"Acta no encontrada",detalle:"No se ha encontrado el archivo de acta que intenta subir."}),l.removerLocal(n)})},n.prototype.removerLocal=function(n){var l=this;b.b.getItem("actasLocal").then(function(t){for(var e=t,o=0;o<e.length;o++)if(e[o].nombre==n.nombre){e.splice(o,1);break}b.b.setItem("actasLocal",JSON.stringify(e)),l.actasLocales=e})},n}(),d=function(){return function(){}}(),g=t("pMnS"),v=t("oBZk"),w=t("Ip0R"),y=t("myAn"),k=t("HNUE"),x=t("c1wO"),L=t("O0/m"),F=t("Xnwc"),C=t("qNRq"),I=t("bwXB"),S=t("48VW"),j=t("euZC"),O=t("YK6p"),A=t("3U93"),M=t("ZYCi"),$=e.nb({encapsulation:0,styles:[[""]],data:{}});function P(n){return e.Hb(0,[(n()(),e.pb(0,0,null,null,1,"ion-icon",[["name","images"],["slot","start"]],null,null,null,v.fb,v.s)),e.ob(1,49152,null,0,s.B,[e.h,e.k],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"images")},null)}function B(n){return e.Hb(0,[(n()(),e.pb(0,0,null,null,1,"ion-icon",[["name","document"],["slot","start"]],null,null,null,v.fb,v.s)),e.ob(1,49152,null,0,s.B,[e.h,e.k],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"document")},null)}function E(n){return e.Hb(0,[(n()(),e.pb(0,0,null,null,15,"ion-item",[],null,null,null,v.hb,v.u)),e.ob(1,49152,null,0,s.G,[e.h,e.k],null,null),(n()(),e.gb(16777216,null,0,1,null,P)),e.ob(3,16384,null,0,w.k,[e.O,e.L],{ngIf:[0,"ngIf"]},null),(n()(),e.gb(16777216,null,0,1,null,B)),e.ob(5,16384,null,0,w.k,[e.O,e.L],{ngIf:[0,"ngIf"]},null),(n()(),e.pb(6,0,null,0,3,"ion-button",[["color","warning"],["fill","clear"],["slot","end"]],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.sincronizar(n.context.$implicit)&&e),e},v.P,v.c)),e.ob(7,49152,null,0,s.j,[e.h,e.k],{color:[0,"color"],fill:[1,"fill"]},null),(n()(),e.pb(8,0,null,0,1,"ion-icon",[["name","cloud-upload"]],null,null,null,v.fb,v.s)),e.ob(9,49152,null,0,s.B,[e.h,e.k],{name:[0,"name"]},null),(n()(),e.pb(10,0,null,0,5,"ion-label",[],null,null,null,v.ib,v.v)),e.ob(11,49152,null,0,s.M,[e.h,e.k],null,null),(n()(),e.pb(12,0,null,0,1,"h2",[],null,null,null,null,null)),(n()(),e.Fb(-1,null,["--/--/-- --:--"])),(n()(),e.pb(14,0,null,0,1,"p",[],null,null,null,null,null)),(n()(),e.Fb(15,null,["",""]))],function(n,l){n(l,3,0,"jpg"==l.context.$implicit.ext||"jpeg"==l.context.$implicit.ext||"png"==l.context.$implicit.ext),n(l,5,0,"jpg"!=l.context.$implicit.ext&&"jpeg"!=l.context.$implicit.ext&&"png"!=l.context.$implicit.ext),n(l,7,0,"warning","clear"),n(l,9,0,"cloud-upload")},function(n,l){n(l,15,0,l.context.$implicit.nombre)})}function H(n){return e.Hb(0,[(n()(),e.pb(0,0,null,null,1,"ion-icon",[["name","images"],["slot","start"]],null,null,null,v.fb,v.s)),e.ob(1,49152,null,0,s.B,[e.h,e.k],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"images")},null)}function q(n){return e.Hb(0,[(n()(),e.pb(0,0,null,null,1,"ion-icon",[["name","document"],["slot","start"]],null,null,null,v.fb,v.s)),e.ob(1,49152,null,0,s.B,[e.h,e.k],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"document")},null)}function T(n){return e.Hb(0,[(n()(),e.pb(0,0,null,null,16,"ion-item",[],null,null,null,v.hb,v.u)),e.ob(1,49152,null,0,s.G,[e.h,e.k],null,null),(n()(),e.gb(16777216,null,0,1,null,H)),e.ob(3,16384,null,0,w.k,[e.O,e.L],{ngIf:[0,"ngIf"]},null),(n()(),e.gb(16777216,null,0,1,null,q)),e.ob(5,16384,null,0,w.k,[e.O,e.L],{ngIf:[0,"ngIf"]},null),(n()(),e.pb(6,0,null,0,3,"ion-button",[["fill","clear"],["slot","end"]],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.descargar(n.context.$implicit)&&e),e},v.P,v.c)),e.ob(7,49152,null,0,s.j,[e.h,e.k],{fill:[0,"fill"]},null),(n()(),e.pb(8,0,null,0,1,"ion-icon",[["name","download"]],null,null,null,v.fb,v.s)),e.ob(9,49152,null,0,s.B,[e.h,e.k],{name:[0,"name"]},null),(n()(),e.pb(10,0,null,0,6,"ion-label",[],null,null,null,v.ib,v.v)),e.ob(11,49152,null,0,s.M,[e.h,e.k],null,null),(n()(),e.pb(12,0,null,0,2,"h2",[],null,null,null,null,null)),(n()(),e.Fb(13,null,["",""])),e.Bb(14,2),(n()(),e.pb(15,0,null,0,1,"p",[],null,null,null,null,null)),(n()(),e.Fb(16,null,["",""]))],function(n,l){n(l,3,0,"jpg"==l.context.$implicit.ext||"jpeg"==l.context.$implicit.ext||"png"==l.context.$implicit.ext),n(l,5,0,"jpg"!=l.context.$implicit.ext&&"jpeg"!=l.context.$implicit.ext&&"png"!=l.context.$implicit.ext),n(l,7,0,"clear"),n(l,9,0,"download")},function(n,l){var t=e.Gb(l,13,0,n(l,14,0,e.yb(l.parent,0),l.context.$implicit.fechaCreacion,"dd/MM/yyyy HH:mm"));n(l,13,0,t),n(l,16,0,l.context.$implicit.documento.nombre)})}function N(n){return e.Hb(0,[e.Ab(0,w.d,[e.u]),e.Db(402653184,1,{fileChooser:0}),(n()(),e.pb(2,0,null,null,16,"ion-header",[],null,null,null,v.eb,v.r)),e.ob(3,49152,null,0,s.A,[e.h,e.k],null,null),(n()(),e.pb(4,0,null,0,14,"ion-toolbar",[],null,null,null,v.zb,v.M)),e.ob(5,49152,null,0,s.Ab,[e.h,e.k],null,null),(n()(),e.pb(6,0,null,0,5,"ion-buttons",[["slot","start"]],null,null,null,v.Q,v.d)),e.ob(7,49152,null,0,s.k,[e.h,e.k],null,null),(n()(),e.pb(8,0,null,0,3,"ion-button",[],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.navegar("/app/home")&&e),e},v.P,v.c)),e.ob(9,49152,null,0,s.j,[e.h,e.k],null,null),(n()(),e.pb(10,0,null,0,1,"ion-icon",[["name","arrow-back"],["slot","icon-only"]],null,null,null,v.fb,v.s)),e.ob(11,49152,null,0,s.B,[e.h,e.k],{name:[0,"name"]},null),(n()(),e.pb(12,0,null,0,2,"ion-title",[],null,null,null,v.yb,v.L)),e.ob(13,49152,null,0,s.yb,[e.h,e.k],null,null),(n()(),e.Fb(-1,0,["Actas COPASST"])),(n()(),e.pb(15,0,null,0,3,"ion-buttons",[["slot","end"]],null,null,null,v.Q,v.d)),e.ob(16,49152,null,0,s.k,[e.h,e.k],null,null),(n()(),e.pb(17,0,null,0,1,"ion-menu-button",[],null,null,null,v.kb,v.y)),e.ob(18,49152,null,0,s.Q,[e.h,e.k],null,null),(n()(),e.pb(19,0,null,null,23,"ion-content",[],null,null,null,v.Y,v.l)),e.ob(20,49152,null,0,s.t,[e.h,e.k],null,null),(n()(),e.gb(16777216,null,0,1,null,E)),e.ob(22,278528,null,0,w.j,[e.O,e.L,e.s],{ngForOf:[0,"ngForOf"]},null),(n()(),e.gb(16777216,null,0,1,null,T)),e.ob(24,278528,null,0,w.j,[e.O,e.L,e.s],{ngForOf:[0,"ngForOf"]},null),(n()(),e.pb(25,0,null,0,0,"div",[["style","height: 75px;"]],null,null,null,null,null)),(n()(),e.pb(26,0,null,0,15,"ion-fab",[["horizontal","end"],["slot","fixed"],["vertical","bottom"]],null,null,null,v.cb,v.n)),e.ob(27,49152,null,0,s.v,[e.h,e.k],{horizontal:[0,"horizontal"],vertical:[1,"vertical"]},null),(n()(),e.pb(28,0,null,0,3,"ion-fab-button",[],null,null,null,v.ab,v.o)),e.ob(29,49152,null,0,s.w,[e.h,e.k],null,null),(n()(),e.pb(30,0,null,0,1,"ion-icon",[["name","add"]],null,null,null,v.fb,v.s)),e.ob(31,49152,null,0,s.B,[e.h,e.k],{name:[0,"name"]},null),(n()(),e.pb(32,0,null,0,9,"ion-fab-list",[["side","top"]],null,null,null,v.bb,v.p)),e.ob(33,49152,null,0,s.x,[e.h,e.k],{side:[0,"side"]},null),(n()(),e.pb(34,0,null,0,3,"ion-fab-button",[],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.openFileChooser()&&e),e},v.ab,v.o)),e.ob(35,49152,null,0,s.w,[e.h,e.k],null,null),(n()(),e.pb(36,0,null,0,1,"ion-icon",[["name","document"]],null,null,null,v.fb,v.s)),e.ob(37,49152,null,0,s.B,[e.h,e.k],{name:[0,"name"]},null),(n()(),e.pb(38,0,null,0,3,"ion-fab-button",[],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.getPicture()&&e),e},v.ab,v.o)),e.ob(39,49152,null,0,s.w,[e.h,e.k],null,null),(n()(),e.pb(40,0,null,0,1,"ion-icon",[["name","camera"]],null,null,null,v.fb,v.s)),e.ob(41,49152,null,0,s.B,[e.h,e.k],{name:[0,"name"]},null),(n()(),e.pb(42,0,[[1,0],["fileChooser",1]],0,0,"input",[["style","display: none;"],["type","file"]],null,[[null,"change"]],function(n,l,t){var o=!0;return"change"===l&&(o=!1!==n.component.upload(e.yb(n,42).files)&&o),o},null,null))],function(n,l){var t=l.component;n(l,11,0,"arrow-back"),n(l,22,0,t.actasLocales),n(l,24,0,t.actasList),n(l,27,0,"end","bottom"),n(l,31,0,"add"),n(l,33,0,"top"),n(l,37,0,"document"),n(l,41,0,"camera")},null)}function U(n){return e.Hb(0,[(n()(),e.pb(0,0,null,null,6,"sm-consultaActas",[],null,null,null,N,$)),e.Cb(512,null,c.a,c.a,[]),e.Cb(512,null,r.a,r.a,[]),e.Cb(512,null,a.a,a.a,[]),e.Cb(512,null,i.a,i.a,[y.a,p.a]),e.Cb(512,null,o.a,o.a,[k.a,x.a,L.a,F.a,C.a,I.a,S.a,j.a,O.a,A.a,i.a]),e.ob(6,114688,null,0,m,[s.Eb,p.a,s.a,c.a,r.a,a.a,i.a,o.a,M.m],null,null)],function(n,l){n(l,6,0)},null)}var z=e.lb("sm-consultaActas",m,U,{},{},[]),D=t("gIcY");t.d(l,"ConsultaActasPageModuleNgFactory",function(){return R});var R=e.mb(d,[],function(n){return e.vb([e.wb(512,e.j,e.bb,[[8,[g.a,z]],[3,e.j],e.x]),e.wb(4608,w.m,w.l,[e.u,[2,w.u]]),e.wb(4608,D.s,D.s,[]),e.wb(4608,D.b,D.b,[]),e.wb(4608,s.b,s.b,[e.z,e.g]),e.wb(4608,s.Fb,s.Fb,[s.b,e.j,e.q,w.c]),e.wb(4608,s.Ib,s.Ib,[s.b,e.j,e.q,w.c]),e.wb(1073742336,w.b,w.b,[]),e.wb(1073742336,D.q,D.q,[]),e.wb(1073742336,D.g,D.g,[]),e.wb(1073742336,D.o,D.o,[]),e.wb(1073742336,s.Cb,s.Cb,[]),e.wb(1073742336,M.n,M.n,[[2,M.t],[2,M.m]]),e.wb(1073742336,d,d,[]),e.wb(1024,M.k,function(){return[[{path:"",component:m}]]},[])])})}}]);